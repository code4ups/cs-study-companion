---
import MainLayout from "../../layouts/MainLayout.astro";
import { getEntry, getCollection, type CollectionEntry } from "astro:content";

/** Δηλώνουμε ΟΛΑ τα στατικά paths από en/el. */
export async function getStaticPaths() {
    const en = await getCollection("en");
    const el = await getCollection("el");

    const toParams =
        (lang: "en" | "el") =>
            (entry: CollectionEntry<"en"> | CollectionEntry<"el">) => ({
                params: {
                    lang,
                    segments: entry.slug,
                },
                props: {
                    lang,
                    slug: entry.slug,
                },
            });

    return [...en.map(toParams("en")), ...el.map(toParams("el"))];
}

type Lang = "en" | "el";
interface PageProps { lang: Lang; slug: string; }

const { lang, slug } = Astro.props as PageProps;
const currentLang: Lang = lang === "el" ? "el" : "en";

const entry = await getEntry(currentLang, slug);
if (!entry) {
    throw new Error(`Entry not found for ${currentLang}/${slug}`);
}

const { Content } = await entry.render();
const { title = slug, description = "" } = entry.data as {
    title?: string; description?: string;
};
---

<MainLayout title={title} lang={currentLang}>
    <!-- ΑΦΑΙΡΕΣΗ: Χωρίς default header
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-semibold">{title}</h1>
    </div>
    {description && <p class="text-sm text-slate-500 mb-6">{description}</p>}
    -->

    <article class="prose prose-slate max-w-3xl mx-auto px-6 py-10 lg:prose-lg dark:prose-invert">
        <Content />
    </article>
</MainLayout>